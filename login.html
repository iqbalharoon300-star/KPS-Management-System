<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KPS Login</title>
  <link rel="stylesheet" href="style.css">
  <style>
    body { display:flex; justify-content:center; align-items:center; height:100vh; background:#f2f5f4; }
    .login-box {
      width:360px; background:#fff; padding:30px; border-radius:10px;
      box-shadow:0 4px 15px rgba(0,0,0,0.1); text-align:center;
    }
    .login-box img { width:80px; margin-bottom:10px; }
    h2 { color:#006b3c; margin-bottom:20px; }
    input { width:100%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:6px; }
    button {
      width:100%; padding:12px; background:#006b3c; color:#fff;
      border:none; border-radius:6px; font-weight:700; cursor:pointer;
    }
    button:hover { background:#009e58; }
    #msg{margin-top:10px;font-weight:600}
  </style>
</head>
<body>

<div class="login-box">
  <img src="assets/logo.png" alt="Kcal Logo">
  <h2>KPS Login</h2>

  <form id="loginForm">
    <input type="email" id="email" placeholder="Email" required>
    <input type="password" id="password" placeholder="Password" required>
    <button type="submit">Login</button>
  </form>

  <p id="msg"></p>
</div>

<script type="module">
import { auth, login } from "./app.js";
import { onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.5.0/firebase-auth.js";

document.getElementById("loginForm").addEventListener("submit", async(e)=>{
  e.preventDefault();
  const email = email.value.trim();
  const password = password.value.trim();
  const msg=document.getElementById("msg");

  msg.textContent="Checking...";
  msg.style.color="#444";

  try {
    await login(email,password);
    msg.textContent="✅ Login Success";
    msg.style.color="green";
    setTimeout(()=>location.href="dashboard.html",800);
  } catch(err){
    msg.textContent="❌ "+err.message;
    msg.style.color="red";
  }
});

// if logged in → go dashboard
onAuthStateChanged(auth,(user)=>{
  if(user) location.href="dashboard.html";
});
</script>

</body>
</html>